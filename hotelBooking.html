<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Booking</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            color: #495057;
        }

        /* Navbar */
        .navbar {
            background-color: #007bff;
        }
        .navbar-brand {
            color: white !important;
            font-weight: bold;
        }

        /* Buttons */
        .btn-custom {
            border-radius: 50px;
            padding: 10px 25px;
        }
        .btn-primary {
            background-color: #007bff;
            border: none;
        }
        .btn-danger {
            background-color: #dc3545;
            border: none;
        }
        .btn-warning {
            background-color: #ffc107;
            border: none;
        }

        .container {
            max-width: 900px;
            margin-top: 20px;
        }

        /* Table styling */
        .room-table td, .room-table th {
            padding: 15px;
        }

        /* Modal Styling */
        .modal-content {
            border-radius: 12px;
        }
        .modal-header {
            background-color: #007bff;
            color: white;
        }
        .modal-footer button {
            border-radius: 50px;
        }

        /* Breakdown & Notification */
        .notification {
            padding: 20px;
            background-color: #28a745;
            color: white;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }
    </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Hotel System</a>
        <a href="pos.html" class="btn btn-warning mx-2">POS</a>
        <a href="index.html" class="btn btn-danger mx-2">Logout</a>
    </div>
</nav>

<!-- Date Selector -->
<div class="container mt-4">
    <label for="dateSelector">Select Date:</label>
    <input type="date" class="form-control" id="dateSelector">
</div>

<!-- Available Rooms -->
<div class="container mt-5">
    <h3>Available Rooms</h3>
    <table class="table table-striped room-table">
        <thead>
            <tr>
                <th scope="col">Room</th>
                <th scope="col">Status</th>
                <th scope="col">Action</th>
            </tr>
        </thead>
        <tbody id="roomBody">
            <!-- Room data will populate dynamically -->
        </tbody>
    </table>

    <!-- Create Booking Button -->
    <button class="btn btn-primary btn-custom" data-bs-toggle="modal" data-bs-target="#createBookingModal">Create New Booking</button>
</div>

<!-- Modal to Create New Booking -->
<div class="modal fade" id="createBookingModal" tabindex="-1" aria-labelledby="createBookingModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="createBookingModalLabel">Create Booking</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="bookingForm">
                    <div class="mb-3">
                        <label for="guestName" class="form-label">Guest Name</label>
                        <input type="text" class="form-control" id="guestName" required>
                    </div>
                    <div class="mb-3">
                        <label for="arrivalDate" class="form-label">Arrival Date</label>
                        <input type="date" class="form-control" id="arrivalDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="departureDate" class="form-label">Departure Date</label>
                        <input type="date" class="form-control" id="departureDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="roomNumber" class="form-label">Select Room</label>
                        <select class="form-control" id="roomNumber" required>
                            <!-- Available rooms will populate here -->
                        </select>
                    </div>
                    <button type="button" class="btn btn-warning btn-custom" id="findRoomBtn">Find Available Room</button>
                    <div class="mb-3 mt-3">
                        <label for="tab" class="form-label">Add Tab (£50 Deposit)</label>
                        <input type="checkbox" id="tab"> Add £50 deposit
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="confirmBookingBtn">Confirm Booking</button>
            </div>
        </div>
    </div>
</div>

<!-- Breakdown Notification -->
<div class="notification" id="notification">
    <p><strong>Booking confirmed!</strong></p>
    <p>Details are saved and a £50 deposit was added to the tab.</p>
</div>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
<script>
    let bookings = [];
    let availableRooms = ["101", "102", "103", "104", "105", "106"];
    let roomStatus = {
        "101": "Dirty",
        "102": "Dirty",
        "103": "Dirty",
        "104": "Dirty",
        "105": "Dirty",
        "106": "Dirty"
    };

    // Populate available rooms in the form
    function populateRoomOptions() {
        const roomSelect = document.getElementById('roomNumber');
        roomSelect.innerHTML = '';
        availableRooms.forEach(room => {
            let option = document.createElement('option');
            option.value = room;
            option.innerText = `Room ${room}`;
            roomSelect.appendChild(option);
        });
    }

    // Display bookings in table
    function displayBookings() {
        const roomBody = document.getElementById('roomBody');
        roomBody.innerHTML = '';
        bookings.forEach((booking, index) => {
            let row = roomBody.insertRow();
            row.innerHTML = `
                <td>${booking.roomNumber}</td>
                <td><span class="badge badge-${roomStatus[booking.roomNumber] === 'Clean' ? 'success' : 'warning'}">${roomStatus[booking.roomNumber]}</span></td>
                <td>
                    <button class="btn btn-primary btn-custom" onclick="showBreakdown(${index})">Breakdown</button>
                    <button class="btn btn-info btn-custom" onclick="showDetails(${index})">Details</button>
                    <button class="btn btn-success btn-custom" onclick="checkIn(${index})">Check In</button>
                </td>
            `;
        });
    }

    // Show booking details
    function showDetails(index) {
        const booking = bookings[index];
        alert(`Booking details:\nGuest Name: ${booking.guestName}\nRoom Number: ${booking.roomNumber}\nArrival Date: ${booking.arrivalDate}\nDeparture Date: ${booking.departureDate}`);
    }

    // Show booking breakdown (costs)
    function showBreakdown(index) {
        const booking = bookings[index];
        const roomCost = 75 * (new Date(booking.departureDate) - new Date(booking.arrivalDate)) / (1000 * 3600 * 24); // Calculate nights
        const deposit = booking.tab ? 50 : 0;
        alert(`Booking breakdown:\nGuest Name: ${booking.guestName}\nRoom: ${booking.roomNumber}\nTotal Room Cost: £${roomCost}\nDeposit: £${deposit}\nTotal: £${roomCost + deposit}`);
    }

    // Confirm booking
    document.getElementById('confirmBookingBtn').addEventListener('click', function () {
        const guestName = document.getElementById('guestName').value;
        const arrivalDate = document.getElementById('arrivalDate').value;
        const departureDate = document.getElementById('departureDate').value;
        const roomNumber = document.getElementById('roomNumber').value;
        const tab = document.getElementById('tab').checked;

        if (!guestName || !arrivalDate || !departureDate || !roomNumber) {
            alert("Please fill in all fields.");
            return;
        }

        const booking = { guestName, arrivalDate, departureDate, roomNumber, tab };
        bookings.push(booking);
        roomStatus[roomNumber] = "Booked";
        displayBookings();
        document.getElementById('notification').style.display = 'block';
        setTimeout(() => {
            document.getElementById('notification').style.display = 'none';
        }, 3000);

        // Reset the form and close the modal
        document.getElementById('bookingForm').reset();
        const modal = bootstrap.Modal.getInstance(document.getElementById('createBookingModal'));
        modal.hide();
    });

    // Initialize room options and display bookings
    populateRoomOptions();
    displayBookings();
</script>
</body>
</html>
